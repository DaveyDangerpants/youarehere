<!DOCTYPE html>

<html lang="en">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <title>You Are Here</title><!--[if le IE 9]>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="scripts/respond.js"></script>
    <![endif]-->
  <link href="https://fonts.googleapis.com/css?family=Markazi+Text" rel="stylesheet" type='text/css'>
  <link href="styles/normalize.css" rel="stylesheet" type="text/css">
  
  <!-- Below is your custom application script -->
  <script src="scripts/app.js" type="text/javascript"></script>

  <!-- include A-Frame -->
    <script src="https://aframe.io/releases/0.7.0/aframe.min.js"></script>
  <!-- include A-Frame - animation component -->
    <script src="https://unpkg.com/aframe-animation-component@3.2.1/dist/aframe-animation-component.min.js"></script>
  <!-- include ar.js for A-Frame -->
  <script src="https://jeromeetienne.github.io/AR.js/aframe/build/aframe-ar.js"></script>

    <script>
      AFRAME.registerComponent('voicecontrol', {
        init: function () {
          console.log("voicecontrol called");
		},
		tick: function (time, timeDelta) {
          // get scene
          var sceneEl = this.el;  // Or this.el since we're in a component.
          // get model
          var mandalaEl = sceneEl.querySelector('#interactiveMandala');
          // get current frequency
          var currentFreq = freqAvg();
          var positionChange = currentFreq/128;
          console.log("position change factor " + positionChange);
          //mandalaEl.setAttribute('position', '0 0 ' + currentFreq);  
        }
      });
    </script>

</head>

<body onload="voiceChange();" style="margin : 0px; overflow: hidden;">

<script>alert("interactivity 8");</script>
  <a-scene embedded arjs voicecontrol>
  	<!-- assets -->
  	<a-assets>
      <a-asset-item id="mandala" src="https://raw.githubusercontent.com/DaveyDangerpants/youarehere/master/images/mandala/scene.gltf"></a-asset-item>
    </a-assets>
  
    <!-- create your content here. just a box for now -->
    <!--<a-box position='0 0 0' material='opacity: 0.5;'></a-box>-->

    <!-- wrapping the gltf model in an entity to animate -->
	<a-marker type='pattern' url='https://raw.githubusercontent.com/DaveyDangerpants/youarehere/master/images/pattern-marker.patt'>
	<a-entity rotation="90 0 0">
      <a-entity position="0 -10 0" scale="1 1 1" animation="property: rotation; to: 0 0 360; loop: true; easing:linear; dur: 45000;">
        <a-entity id="interactiveMandala" gltf-model="#mandala" scale="0.15 0.15 0.15" position="0 0 0"></a-entity>
      </a-entity>
    </a-entity>
      
	</a-marker>
    <!-- animated lights -->
      <a-entity id="lightSphere" geometry="primitive:sphere; radius:1" material="shader:flat; color:#fff" light="type:point; color:#BBBBFF;" 
                position="0 9 30" rotation="0 0 0">


    <!-- define a camera which will move according to the marker position -->
	<a-entity camera></a-entity>
  </a-scene>

  <h1>You Are Here</h1>
  
</body>
</html>
